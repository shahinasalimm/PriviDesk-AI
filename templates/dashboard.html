<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PrivyDesk AI - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

</head>
<body class="bg-dashboard">

<div class="container py-5">
    <h1 class="text-center mb-4 text-primary">HR Dashboard</h1>
    <p class="text-center text-muted mb-4">Department Mood Summary</p>

    <!-- Burnout Alerts -->
    {% if alerts %}
        <div class="alert alert-danger">
            <h4>⚠️ Burnout Risk Detected!</h4>
            <ul>
                {% for dept in alerts %}
                    <li><strong>{{ dept }}</strong> department is at risk of burnout!</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <canvas id="moodChart" width="400" height="200"></canvas>

    <div class="text-center mt-4">
        <a href="/logout" class="btn btn-danger btn-lg">Logout</a>
    </div>
</div>

<script>
    const chartData = {
        labels: [{% for dept in summary.keys() %}'{{ dept }}'{% if not loop.last %}, {% endif %}{% endfor %}],
        datasets: [
            {
                label: 'Positive',
                backgroundColor: '#28a745',
                data: [{% for dept, sentiments in summary.items() %}{{ sentiments['Positive'] }}{% if not loop.last %}, {% endif %}{% endfor %}]
            },
            {
                label: 'Negative',
                backgroundColor: '#dc3545',
                data: [{% for dept, sentiments in summary.items() %}{{ sentiments['Negative'] }}{% if not loop.last %}, {% endif %}{% endfor %}]
            }
        ]
    };

    const config = {
        type: 'bar',
        data: chartData,
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                title: { display: true, text: 'Department Mood Summary' }
            }
        }
    };

    new Chart(
        document.getElementById('moodChart'),
        config
    );
</script>

</body>
</html>
